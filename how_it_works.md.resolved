# How It Works: Binance Futures Trading Bot

This document explains the internal logic and flow of the trading bot.

## Architecture

The application is built using Python's `asyncio` library for asynchronous execution, allowing it to handle WebSocket data and REST API calls concurrently without blocking.

### Components

1.  **[main.py](file:///c:/Users/shaun/coinw-assessment1/main.py)**: The entry point.
    - Loads configuration from `.env`.
    - Initializes the [BinanceClient](file:///c:/Users/shaun/coinw-assessment1/binance_client.py#13-119).
    - Initializes and runs the [Strategy](file:///c:/Users/shaun/coinw-assessment1/strategy.py#9-102).
    - Handles graceful shutdown on `Ctrl+C`.

2.  **[binance_client.py](file:///c:/Users/shaun/coinw-assessment1/binance_client.py)**: Handles all communication with Binance.
    - **REST API**: Uses `aiohttp` to send HTTP requests (POST, DELETE, GET).
        - Implements HMAC SHA256 signature generation for authentication.
        - Manages the HTTP session.
    - **WebSocket**: Connects to the Binance Futures WebSocket stream to receive real-time market data.

3.  **[strategy.py](file:///c:/Users/shaun/coinw-assessment1/strategy.py)**: Contains the trading logic.
    - **Initialization**: Fetches exchange information (precision rules) for the trading symbol to ensure orders are valid.
    - **Market Data Loop**: Continuously listens to the WebSocket stream for the "Book Ticker" (best bid/ask) and updates the internal state.
    - **Trading Loop**:
        - Waits for a random interval (3-7 seconds).
        - Decides randomly to Buy (Long) or Sell (Short).
        - Calculates the price:
            - **Long**: 95% of the current mid-price.
            - **Short**: 105% of the current mid-price.
        - Rounds the price and quantity according to the asset's precision rules (fixing the "Precision is over the maximum" error).
        - Sends the order via [BinanceClient](file:///c:/Users/shaun/coinw-assessment1/binance_client.py#13-119).
        - Tracks the number of orders placed.
        - **Cancellation**: Every 5 orders, sends a request to cancel all open orders for the symbol.

## Data Flow

1.  **Startup**: The bot starts, logs in with your keys, and fetches the precision rules for the symbol (e.g., SOLUSDT).
2.  **Real-time Data**: The bot subscribes to `wss://stream.binancefuture.com/ws/<symbol>@bookTicker`. It receives updates whenever the best bid or ask changes.
3.  **Decision Making**:
    - The [trading_loop](file:///c:/Users/shaun/coinw-assessment1/strategy.py#45-93) wakes up every 3-7 seconds.
    - It checks the latest bid/ask from the [market_data_loop](file:///c:/Users/shaun/coinw-assessment1/strategy.py#32-44).
    - It calculates a limit price far away from the market price (to ensure it doesn't fill immediately, for demonstration purposes).
4.  **Execution**:
    - An HTTP POST request is sent to `/fapi/v1/order`.
    - If successful, the order ID is logged.
    - If 5 orders have been placed, an HTTP DELETE request is sent to `/fapi/v1/allOpenOrders`.

## Error Handling

- **API Errors**: If Binance returns an error (e.g., invalid precision, insufficient margin), it is caught and logged.
- **WebSocket Disconnection**: If the connection drops, the client attempts to reconnect automatically.
